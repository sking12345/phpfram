<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <title>PHPCALL</title>
    <link href="static/frame/css/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
    <link href="static/frame/css/font-awesome.min93e3.css?v=4.4.0" rel="stylesheet">
    <link href="static/frame/css/animate.min.css" rel="stylesheet">
    <link href="static/frame/css/main.css" rel="stylesheet">
    <script src="static/frame/js/jquery.min.js?v=2.1.4"></script>

</head>
<body >
<div id="content">
    <div class="container-fluid">
        <div class="row">
            <div class="widget-box">
                <div class="widget-title">
                    <span class="icon">
                        <i class="fa fa-th"></i>
                    </span>
                    <h5>crypto</h5>
                    
                </div>
                <div class="widget-content ">
                    <form class="form-horizontal m-t" novalidate="novalidate">
                        <div class="form-group ">
                            <label class="col-sm-1 control-label">加密：</label>
                            <div class="col-sm-9 ">
                                <input type="text" disabled='disabled' class="encode form-control" >
                            </div>
                            <div class="col-sm-1 ">
                                <button class="btn btn-primary" onclick="getEncode()" type="button"> 点我获取</button>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group ">
                            <label class="col-sm-1 control-label">解密：</label>
                            <div class="col-sm-9 ">
                                <input type="text" disabled='disabled' class="decode form-control">
                            </div>
                            <div class="col-sm-1 ">
                                <button class="btn btn-info" onclick="getDecode()" type="button"> 点我获取</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="static/frame/js/bootstrap.min.js?v=3.3.6"></script>
<script src="static/frame/js/crypto-js.js?v=3.3.6"></script> 
<!-- <script src="static/frame/js/plugins/crypto/core.js"></script>
<script src="static/frame/js/plugins/crypto/aes.js"></script>
<script src="static/frame/js/plugins/crypto/md5.js"></script>
<script src="static/frame/js/plugins/crypto/pad-zeropadding.js"></script> -->

<script>
    /**
     * 定义加密函数
     * @param  {[type]} a [形参，需要加密的值]
     * @return {[type]}   [加密后的值]
     */
    function encode(value, key) {
        if (key.length != 32) return; //如果key的长度不等于32则返回
        var key_base, iv_base;

        key_base = key.substring(0, 16);
        iv_base = key.substring(16, 32);

        var get = function (a) {
            var key_hash = CryptoJS.MD5(key_base);
            key_base = CryptoJS.enc.Utf8.parse(key_base);
            iv_base = CryptoJS.enc.Utf8.parse(iv_base);
            var res = CryptoJS.AES.encrypt(
                a,
                key_base,
                {
                    iv: iv_base,
                    mode: CryptoJS.mode.CBC,
                    padding: CryptoJS.pad.Pkcs7 // 后台用的是pad.Pkcs5,前台对应为Pkcs7
                });

            var oldval = CryptoJS.enc.Base64.stringify(res.ciphertext);
            var val = oldval.replace(/\+/g, '-').replace(/\//g, '_').replace(/=/g, '');
            return val;
        }

        //$data = str_replace(array('+', '/', '='), array('-', '_', ''), $data);
        return get(value);
    }
    function decode(data, key) {

        if (key.length != 32) return;  //如果key的长度不等于32则返回

        var key_base = key.substring(0, 16);
        var iv_base = key.substring(16, 32);
        key_base = CryptoJS.enc.Utf8.parse(key_base);
        iv_base = CryptoJS.enc.Utf8.parse(iv_base);

        var rem = data.length % 4;
        var dd = "";
        for (var i = 0; i < (4 - rem); i++) {
            dd += '='
        }
        data = data.replace(/-/g, '+').replace(/_/g, '/');
        data = data + dd;

        data = CryptoJS.AES.decrypt(data, key_base, {
            iv: iv_base,
            mode: CryptoJS.mode.CBC,
            padding: CryptoJS.pad.Pkcs7
        });

        // 经过CryptoJS解密后，依然是一个对象，将其变成明文就需要按照Utf8格式转为字符串
        data = data.toString(CryptoJS.enc.Utf8);
        return  decodeURIComponent(data) ;
    }
       

    function getEncode(data,key){
        $(".encode").val(encode('{"Event":"sysmessage","Data":{"title":"\u8c03\u5ea6\u4e2d\u5fc3","text":"sadfasdfk;asfkaklsdfjlkasjdfklaakjdsfksajdf;kljak;ldf将阿方索卡隆叫啊放假啊快点放假了卡收费s的就看了撒娇反馈时间到饭卡减肥打卡时间发啊快点将发送旅客的肌肤asked啊开始放假啊减肥啊时间发\u6536\u5230\u65b0\u7684\u9884\u7ea6\u8ba2\u5355\uff0c\u5df2\u81ea\u52a8\u6d3e\u5355\u7ed9\u670d\u52a1\u5546\uff08\u91d1\u8fb9\u670d\u52a1\u55461\uff09","url":"?ct=order&ac=de,jsonhandle_order()（）_detail&id=1901102128236997678<script>asdf234567afsghd&*()^%$##@@$%%","time":"2019-01-10 21:28:23"}}', 'dc04fd1f9f07e12e42b5505c9f13d339'));
    }
    function getDecode(data, key) {
        $(".decode").val(decode('FIIsclTM+KXWlhrduddEycTKQXJg+cqsHDPDbGhOSf+gvqQoHoyAFxRFAnEJFE82+mSuNwVLdTzLlPEUUKwYP+VZ1vd8az2O0lAjTkKgu3ZnRtjf1bWklxAUhwnhFXj2eNSJH6aZ0TT5Wa8wnuJM6tgpzjD4jRw3PVZb6jSvZP+R3xXivihfekdIhC4JWgYTTa5tqHVxMUUE9rAtEF0e7BR7UqAkf19T4Yb/cvDGRCpYJE0G7mDnPV3odrmTHb2X0iwbJToSbIzPH2BxOlHTYeqHcL0YOP9Jgx6DX8SLP5wTy8dnxIKWRwqfDvPzJ00RqIcIKQxzceaeiftCA2bhI+5yjOsV2TrQiIAIq8OUCvBlrfbt62L6mX+Un6I1XYXOcgvKGsYRXBPDcY7UjZrPLvNShrM9tYdbcMPfHdlouM9AUPemvj6lDW9DNfRWl/1iITg0knJbUBIbKxZWXXaqoit6BrcoQG9nYYi3LL0iOxbyqgoNE5f5YeqOGGqauJ6x0tAkiz/msjwO522oMUcCg6ncjBMSS3lgupM0GvA3oPJuREXHmY8t2rkfE5wzar3BjFeBYF04eqjUz0W0SYKcmDYKHsLPp7OOhSs0XQdJzbSMHjhu/bztH+VVwz21bvE40RPvnkQxNQ5IEc4my6KwZcJUZRbzikKfRZKbyA0tODM=', 'dc04fd1f9f07e12e42b5505c9f13d339'));
    }

</script>
</body>
</html>
